<div class="pf-c-expandable-section__content">
    <table class="pf-c-table pf-m-grid-md" role="grid">
        <thead>
            <tr role="row"><td role="cell" colspan="2"></td></tr>
        </thead>
        <tbody role="rowgroup">
            <tr role="row">
                <td role="cell"><b>Rule ID:</b></td>
                <td role="cell">{{ rule.rule_id }}</td>
            </tr>
            <tr role="row">
                <td role="cell"><b>Result:</b></td>
                <td role="cell">
                    {% if rule.result == "pass" %}
                    <span class="pf-c-label pf-m-green">
                        <span class="pf-c-label__content">
                            <span class="pf-c-label__icon">
                                <i class="fas fa-fw fa-check" aria-hidden="true"></i>
                            </span>
                            {{ rule.result -}}
                        </span>
                    </span>
                    {% elif rule.result == "fail"%}
                    <span class="pf-c-label pf-m-red">
                        <span class="pf-c-label__content">
                            <span class="pf-c-label__icon">
                                <i class="fas fa-fw fa-times" aria-hidden="true"></i>
                            </span>
                            {{- rule.result -}}
                        </span>
                    </span>
                    {% else %}
                    <span class="pf-c-label">
                        <span class="pf-c-label__content">
                            <span class="pf-c-label__icon">
                                <i class="fas fa-fw fa-question-circle" aria-hidden="true"></i>
                            </span>
                        {{- rule.result -}}
                        </span>
                    </span>
                    {% endif %}
                </td>
            </tr>
            <tr role="row">
                <td role="cell"><b>Multi-check rule:</b></td>
                {% if rule.multi_check %}
                    <td role="cell">yes</td>
                {% else %}
                    <td role="cell">no</td>
                {% endif %}
            </tr>
            <tr role="row">
                <td role="cell"><b>OVAL Definition ID:</b></td>
                <td role="cell">{{ rule.oval_definition_id }}</td>
            </tr>
            <tr role="row">
                <td role="cell"><b>Time:</b></td>
                <td role="cell">{{ rule.time }}</td>
            </tr>
            <tr role="row">
                <td role="cell"><b>Severity:</b></td>
                <td role="cell">
                    {% if rule.result != "pass" and rule.severity == "low" %}
                    <span class="pf-c-label pf-m-blue">
                        <span class="pf-c-label__content">{{ rule.severity }}</span>
                    </span>
                    {% elif rule.result != "pass" and rule.severity == "medium" %}
                    <span class="pf-c-label pf-m-orange">
                        <span class="pf-c-label__content">{{ rule.severity }}</span>
                    </span>
                    {% elif rule.result != "pass" and rule.severity == "high" %}
                    <span class="pf-c-label pf-m-red">
                        <span class="pf-c-label__content">{{ rule.severity }}</span>
                    </span>
                    {% else %}
                    <span class="pf-c-label">
                        <span class="pf-c-label__content">{{ rule.severity }}</span>
                    </span>
                    {% endif %}
                </td>
            </tr>
            {% if rule.identifiers %}
            <tr role="row">
                <td role="cell"><b>Identifiers:</b></td>
                <td role="cell">
                    <div>
                        {% for identifier in rule.identifiers -%}
                        {% if identifier.href %}
                            <a href="{{ identifier.href | replace('&', ';') }}">{{ identifier.text }}</a>
                        {% else %}
                            <a href="identifier_href_not_found">{{ identifier.text }}</a>
                        {% endif %}
                        {{- ", " if not loop.last else "" -}}
                        {%- endfor %}
                    </div>
                </td>
            </tr>
            {% endif %}
            {% if rule.references %}
            <tr role="row">
                <td role="cell"><b>References:</b></td>
                <td role="cell">
                    <div>
                        {% for reference in rule.references -%}
                        {% if reference.href %}
                            <a href="{{ reference.href | replace('&', ';') }}">{{ reference.text }}</a>
                        {% else %}
                            <a href="reference_href_not_found">{{ reference.text }}</a>
                        {% endif %}
                        {{- ", " if not loop.last else "" -}}
                        {%- endfor %}
                    </div>
                </td>
            </tr>
            {% endif %}
            <tr role="row">
                <td role="cell"><b>Description:</b></td>
                <td role="cell">{{ rule.description }}</td>
            </tr>
            {% if rule.rationale %}
            <tr role="row">
                <td role="cell"><b>Rationale:</b></td>
                <td role="cell">{{ rule.rationale }}</td>
            </tr>
            {% endif %}
            {% if rule.warnings %}
            <tr role="row">
                <td role="cell"><b>Warnings:</b></td>
                <td role="cell">
                    {% for warning in rule.warnings %}
                    <div class="pf-c-alert pf-m-warning pf-m-inline">
                        <div class="pf-c-alert__icon">
                            <i class="fas fa-fw fa-exclamation-triangle" aria-hidden="true"></i>
                        </div>
                        <p class="pf-c-alert__title">
                            <span class="pf-screen-reader">Warning alert:</span>
                            {{- warning -}}
                        </p>
                    </div>
                    <br>
                    {% endfor %}
                </td>
            </tr>
            {% endif %}
            {% if rule.message != "" %}
            <tr role="row">
                <td role="cell"><b>Message:</b></td>
                <td role="cell">
                    <div class="pf-c-alert pf-m-info pf-m-inline">
                        <div class="pf-c-alert__icon">
                            <i class="fas fa-fw fa-info-circle" aria-hidden="true"></i>
                        </div>
                        <p class="pf-c-alert__title">
                            <span class="pf-screen-reader">Message:</span>
                            {{ rule.message }}
                        </p>
                    </div>
                </td>
            </tr>
            {% endif %}
            {% include "remedations.html" %}
            <tr role="row">
                <td colspan="2" role="cell">
                    {%- include "oval_graph.html" %}
                </td>
            </tr>
            <tr role="row">
                <td colspan="2" role="cell">
                    {%- include "cpe_graph.html" %}
                </td>
            </tr>
        </tbody>
    </table>
</div>
